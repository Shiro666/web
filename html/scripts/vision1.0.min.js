var dialogInstace,onMoveStartId,mousePos={x:0,y:0};function g(a){return document.getElementById(a)}function autoCenter(c){var d=document.documentElement.clientWidth;var a=document.documentElement.clientHeight;var e=c.offsetWidth;var b=c.offsetHeight;c.style.left=(d-e)/2+"px";c.style.top=(a-b)/2+"px"}function fillToBody(a){a.style.width=document.documentElement.clientWidth+"px";a.style.height=document.documentElement.clientHeight+"px"}function Dialog(b,a){var c={};c.dragElement=g(b);c.moveElement=g(a);c.mouseOffsetLeft=0;c.mouseOffsetTop=0;c.dragElement.addEventListener("mousedown",function(d){var d=d||window.event;dialogInstace=c;c.mouseOffsetLeft=d.pageX-c.moveElement.offsetLeft;c.mouseOffsetTop=d.pageY-c.moveElement.offsetTop;onMoveStartId=setInterval(onMoveStart,10);return false});return c}document.onmouseup=function(a){dialogInstace=false;clearInterval(onMoveStartId)};document.onmousemove=function(a){var a=window.event||a;mousePos.x=a.clientX;mousePos.y=a.clientY;a.stopPropagation&&a.stopPropagation();a.cancelBubble=true;a=this.originalEvent;a&&(a.preventDefault?a.preventDefault():a.returnValue=false);document.body.style.MozUserSelect="none"};function onMoveStart(){var b=dialogInstace;if(b){var c=document.documentElement.clientWidth-b.moveElement.offsetWidth;var a=document.documentElement.clientHeight-b.moveElement.offsetHeight;b.moveElement.style.left=Math.min(Math.max((mousePos.x-b.mouseOffsetLeft),0),c)+"px";b.moveElement.style.top=Math.min(Math.max((mousePos.y-b.mouseOffsetTop),0),a)+"px"}}function showDialog(){g("dialogMove").style.display="block";g("mask").style.display="block";autoCenter(g("dialogMove"));fillToBody(g("mask"))}function hideDialog(){g("dialogMove").style.display="none";g("mask").style.display="none"}Dialog("dialogDrag","dialogMove");function log_off(){$.cookie("nickname","",{expires:-1,path:"/"});$.cookie("password","",{expires:-1,path:"/"});$.cookie("phone_number","",{expires:-1,path:"/"});$.cookie("email","",{expires:-1,path:"/"});$.cookie("user_id","",{expires:-1,path:"/"});location.reload(true);$("#Aprf2").show();$("#Aprf1").hide()}if($.cookie("nickname")){$("#Aprf2").hide();$("#Aprf1").html('<a href="PERSONAL_INFO.html?user_id='+$.cookie("user_id")+'">['+$.cookie("nickname")+']</a>&nbsp;&nbsp;<a href="javascript:;" onclick="log_off()">[退出登录]</a> ').show()}else{$("#Aprf1").hide()}$("#warn").hide();$("#ui-dialog-submit").bind("click",function(){var b=$("#username").val();var a=$("#password").val();if(($.cookie("phone_number")==b)||($.cookie("email")==b)){if($.cookie("password")==a){$("#ui-dialog-closebutton").click();location.reload(true);$("#Aprf2").hide();$("#Aprf1").html('<a href="PERSONAL_INFO.html?user_id='+$.cookie("user_id")+'">['+$.cookie("nickname")+']</a>&nbsp;&nbsp;<a href="javascript:;" onclick="log_off()">[退出登录]</a> ').show()}else{$("#warn").show()}}else{$.cookie("nickname","",{expires:-1,path:"/"});$.cookie("password","",{expires:-1,path:"/"});$.cookie("phone_number","",{expires:-1,path:"/"});$.cookie("email","",{expires:-1,path:"/"});$.cookie("user_id","",{expires:-1,path:"/"});$.ajax({type:"POST",url:"login.php",data:{phone_number_or_email:b,password:a},async:false,dataType:"json",success:function(c){if(c['0'].status=="success"){$.cookie("nickname",c['0'].nickname,{path:"/",expires:7});$.cookie("phone_number",c['0'].phone_number,{path:"/",expires:7});$.cookie("email",c['0'].email,{path:"/",expires:7});$.cookie("password",c['0'].password,{path:"/",expires:7});$.cookie("user_id",c['0'].user_id,{path:"/",expires:7});$("#ui-dialog-closebutton").click();location.reload(true);$("#Aprf2").hide();$("#Aprf1").html('<a href="PERSONAL_INFO.html?user_id='+$.cookie("user_id")+'">['+c['0'].nickname+']</a>&nbsp;&nbsp;<a href="javascript:;" onclick="log_off()">[退出登录]</a> ').show()}if(c['0'].status=="fail"){$("#warn").show()}},error:function(c,e,d){alert("状态码："+c.status+" 状态："+c.readyState+" 错误信息："+e);location.reload(true)}})}});$("#password").bind("blur",function(){$("#warn").hide()});