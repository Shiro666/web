var dialogInstace,onMoveStartId,mousePos={x:0,y:0};function g(a){return document.getElementById(a)}function autoCenter(c){var d=document.documentElement.clientWidth;var a=document.documentElement.clientHeight;var e=c.offsetWidth;var b=c.offsetHeight;c.style.left=(d-e)/2+"px";c.style.top=(a-b)/2+"px"}function fillToBody(a){a.style.width=document.documentElement.clientWidth+"px";a.style.height=document.documentElement.clientHeight+"px"}function Dialog(b,a){var c={};c.dragElement=g(b);c.moveElement=g(a);c.mouseOffsetLeft=0;c.mouseOffsetTop=0;c.dragElement.addEventListener("mousedown",function(d){var d=d||window.event;dialogInstace=c;c.mouseOffsetLeft=d.pageX-c.moveElement.offsetLeft;c.mouseOffsetTop=d.pageY-c.moveElement.offsetTop;onMoveStartId=setInterval(onMoveStart,10);return false});return c}document.onmouseup=function(a){dialogInstace=false;clearInterval(onMoveStartId)};document.onmousemove=function(a){var a=window.event||a;mousePos.x=a.clientX;mousePos.y=a.clientY;a.stopPropagation&&a.stopPropagation();a.cancelBubble=true;a=this.originalEvent;a&&(a.preventDefault?a.preventDefault():a.returnValue=false);document.body.style.MozUserSelect="none"};function onMoveStart(){var b=dialogInstace;if(b){var c=document.documentElement.clientWidth-b.moveElement.offsetWidth;var a=document.documentElement.clientHeight-b.moveElement.offsetHeight;b.moveElement.style.left=Math.min(Math.max((mousePos.x-b.mouseOffsetLeft),0),c)+"px";b.moveElement.style.top=Math.min(Math.max((mousePos.y-b.mouseOffsetTop),0),a)+"px"}}function showDialog(){g("dialogMove").style.display="block";g("mask").style.display="block";autoCenter(g("dialogMove"));fillToBody(g("mask"))}function hideDialog(){g("dialogMove").style.display="none";g("mask").style.display="none"}Dialog("dialogDrag","dialogMove");function log_off(){jQuery.cookie("nickname","",{expires:-1,path:"/"});jQuery.cookie("password","",{expires:-1,path:"/"});jQuery.cookie("phone_number","",{expires:-1,path:"/"});jQuery.cookie("email","",{expires:-1,path:"/"});jQuery.cookie("user_id","",{expires:-1,path:"/"});location.reload(true);jQuery("#Aprf2").show();jQuery("#Aprf1").hide()}if(jQuery.cookie("nickname")){jQuery("#Aprf2").hide();jQuery("#Aprf1").html('<a href="PERSONAL_INFO.html?user_id='+jQuery.cookie("user_id")+'">['+jQuery.cookie("nickname")+']</a>&nbsp;&nbsp;<a href="javascript:;" onclick="log_off()">[退出登录]</a> ').show()}else{jQuery("#Aprf1").hide()}jQuery("#warn").hide();jQuery("#ui-dialog-submit").bind("click",function(){var b=jQuery("#username").val();var a=jQuery("#password").val();if((jQuery.cookie("phone_number")==b)||(jQuery.cookie("email")==b)){if(jQuery.cookie("password")==a){jQuery("#ui-dialog-closebutton").click();location.reload(true);jQuery("#Aprf2").hide();jQuery("#Aprf1").html('<a href="PERSONAL_INFO.html?user_id='+jQuery.cookie("user_id")+'">['+jQuery.cookie("nickname")+']</a>&nbsp;&nbsp;<a href="javascript:;" onclick="log_off()">[退出登录]</a> ').show()}else{jQuery("#warn").show()}}else{jQuery.cookie("nickname","",{expires:-1,path:"/"});jQuery.cookie("password","",{expires:-1,path:"/"});jQuery.cookie("phone_number","",{expires:-1,path:"/"});jQuery.cookie("email","",{expires:-1,path:"/"});jQuery.cookie("user_id","",{expires:-1,path:"/"});jQuery.ajax({type:"POST",url:"../../html/login.php",data:{phone_number_or_email:b,password:a},async:false,dataType:"json",success:function(c){if(c.status=="success"){jQuery.cookie("nickname",c.nickname,{path:"/",expires:7});jQuery.cookie("phone_number",c.phone_number,{path:"/",expires:7});jQuery.cookie("email",c.email,{path:"/",expires:7});jQuery.cookie("password",c.password,{path:"/",expires:7});jQuery.cookie("user_id",c.user_id,{path:"/",expires:7});jQuery("#ui-dialog-closebutton").click();location.reload(true);jQuery("#Aprf2").hide();jQuery("#Aprf1").html('<a href="PERSONAL_INFO.html?user_id='+jQuery.cookie("user_id")+'">['+c.nickname+']</a>&nbsp;&nbsp;<a href="javascript:;" onclick="log_off()">[退出登录]</a> ').show()}if(c.status=="fail"){jQuery("#warn").show()}},error:function(c,e,d){alert("状态码："+c.status+" 状态："+c.readyState+" 错误信息："+e);location.reload(true)}})}});jQuery("#password").bind("blur",function(){jQuery("#warn").hide()});